name: ğŸš€ Deploy Backend (PHP) qua SFTP

on:
  push:
    branches:
      - main
    # Chá»‰ cháº¡y khi cÃ³ thay Ä‘á»•i trong thÆ° má»¥c 'backend/'
    paths:
      - 'backend/**' 

jobs:
  deploy_backend:
    runs-on: ubuntu-latest
    environment: production_backend

    steps:
    - name: â¬‡ï¸ Checkout MÃ£ Nguá»“n
      uses: actions/checkout@v4
      
    - name: ğŸ“‚ Triá»ƒn khai qua SFTP
      uses: SamKirkland/FTP-Deploy-Action@v4.3.0
      with:
        # Láº¥y thÃ´ng tin tá»« GitHub Secrets Ä‘Ã£ thiáº¿t láº­p
        server: ${{ secrets.FTP_HOST }}
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        
        # ThÆ° má»¥c cá»¥c bá»™ cáº§n Ä‘áº©y Ä‘i (CHá»ˆ Äáº¨Y thÆ° má»¥c backend)
        local-dir: './backend/'
        
        # ThÆ° má»¥c Ä‘Ã­ch trÃªn host (ÄÆ°á»ng dáº«n tuyá»‡t Ä‘á»‘i Ä‘Ã£ xÃ¡c Ä‘á»‹nh)
        server-dir: ${{ secrets.FTP_TARGET_DIR }}
        
        protocol: sftp 
        port: 22 

    - name: âœ… Triá»ƒn khai Backend hoÃ n táº¥t
      run: echo "Backend files deployed to Shared Host successfully!"
